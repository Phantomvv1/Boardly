<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>WebSocket Chat</title>
	<style>
		body {
			font-family: sans-serif;
			margin: 0;
			padding: 0;
			background: #f9f9f9;
			display: flex;
			flex-direction: column;
			height: 100vh;
		}

		#chat {
			flex-grow: 1;
			overflow-y: auto;
			padding: 1rem;
			border-bottom: 1px solid #ccc;
		}

		#form {
			display: flex;
			padding: 1rem;
			background: #fff;
		}

		#input {
			flex: 1;
			padding: 0.5rem;
			font-size: 1rem;
			border: 1px solid #ccc;
			border-radius: 4px;
		}

		#send {
			margin-left: 0.5rem;
			padding: 0.5rem 1rem;
			font-size: 1rem;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 4px;
			cursor: pointer;
		}

		#send:hover {
			background-color: #45a049;
		}

		.msg {
			margin-bottom: 0.5rem;
			padding: 0.4rem;
			background: #e0e0e0;
			border-radius: 4px;
			word-wrap: break-word;
		}
	</style>
</head>

<body>
	<div id="chat"></div>
	<form id="form">
		<input id="input" type="text" autocomplete="off" placeholder="Message" required />
		<button id="send" type="submit">Send</button>
	</form>

	<script>
		const chat = document.getElementById("chat");
		const form = document.getElementById("form");
		const input = document.getElementById("input");

		// Connect to the WebSocket server
		const socket = new WebSocket("ws://localhost:42069/ws/chat");

		socket.addEventListener("open", () => {
			console.log("Connected to WebSocket server.");
		});

		socket.addEventListener("message", (event) => {
			const msg = document.createElement("div");
			msg.className = "msg";
			msg.textContent = event.data;
			chat.appendChild(msg);
			chat.scrollTop = chat.scrollHeight;
		});

		socket.addEventListener("close", () => {
			const msg = document.createElement("div");
			msg.className = "msg";
			msg.style.color = "red";
			msg.textContent = "[Disconnected from server]";
			chat.appendChild(msg);
		});

		form.addEventListener("submit", (e) => {
			e.preventDefault();
			if (input.value && socket.readyState === WebSocket.OPEN) {
				socket.send(input.value);
				input.value = "";
			}
		});
	</script>
</body>

</html>
